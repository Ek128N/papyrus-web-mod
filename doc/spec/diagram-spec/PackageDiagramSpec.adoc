////
 Copyright (c) 2024 CEA LIST, Artal Technologies.
 This program and the accompanying materials
 are made available under the terms of the Eclipse Public License v2.0
 which accompanies this distribution, and is available at
 https://www.eclipse.org/legal/epl-2.0/

 SPDX-License-Identifier: EPL-2.0

 Contributors:
     Aurelien Didier (Artal Technologies) - Issue 201
////

= Package Diagram specification
:toc:
:toclevels: 3

== Can create
Can be created under a Package, under a Model and under a Profile.

== Initialization
Nothing special.

== Nodes

=== Comment
Can be created under a Package Diagram, under a Model or a Package.

==== On Creation
Nothing special.

==== Can create
Always

==== OnSet
Nothing special.

==== On Reconnect
Nothing special.

==== On Deletion
Nothing special.

==== On Semantic DnD
Display the view

==== On Direct Edit
Edit the body of the Comment.

==== Label
The body

image::Shared/Comment.png[title="Representation Comment"]

=== Model
Can be created in a Package Diagram, under Model and under a Package.

==== On Creation
Nothing special.

==== Can create
Nothing special.

==== OnSet
Nothing special.

==== On Reconnect
Nothing special.

==== On Deletion
Nothing special.

==== On Semantic DnD
Nothing special.

==== On Direct Edit
Nothing special.

==== Label
Nothing special.
 
image::PackageDiagram/Model.png[title="Representation Model"]

=== Package
Can be created in a Package Diagram, under Model and under a Package.

==== On Creation
Nothing special.

==== Can create
Nothing special.

==== OnSet
Nothing special.

==== On Reconnect
Nothing special.

==== On Deletion
Delete all connected "PackageMerge" and "PackageImport"

==== On Semantic DnD
Nothing special.

==== On Direct Edit
Change package Name

==== Label
Nothing special.
 
image::PackageDiagram/Package.png[title="Representation Package"]




=== PackageImport

==== On Creation
importingPackage := source // also container
importedPackage := target

==== Can Create
(source or target) !=null
When import already exists, some confirmation is required on diagram (but not

==== On Deletion
No-op
When deleting target, import must be deleted (Existing and improper code)

==== On Semantic DnD
When (source or target) ==null, delete

==== On Direct Edit
N/A: no label

==== On reconnection
Source
The container of the PackageImport should change to the new source
org.eclipse.uml2.uml.PackageImport.setImportingNamespace(Namespace)
Target
org.eclipse.uml2.uml.PackageImport.setImportedPackage(Package)

==== Label
«import» when public visibility (but sometimes it fails)
«access» otherwise

== Edges

=== Abstraction
Can be created in a Package Diagram, under Model and under a Package.

==== On Creation
Abstraction link is stored under the source semantic element.
The source element should be added to the clients feature
The source element should be added to the supplier feature

==== Can create
Source and target should be a NamedElement.

==== Container
The container is:
The source node if it can contains the Abstraction
The most common Package between the source and the target otherwise

==== OnSet
Nothing special.

==== On Reconnect
Abstraction link is relocated under the new source semantic element.

==== On Deletion
No special deletion behavior for this element.

==== On Semantic DnD
Nothing special.

==== On Direct Edit
Nothing special.

==== Label
Label shall be prefixed with &laquo;abstraction&raquo; (followed by the name of the link).
 
image::PackageDiagram/Abstraction.png[title="Representation Abstraction"]

=== ContainmentLink
Can be created in a Package Diagram, under Model and under a Package. +
ContainmentLink is a feature based edge (it does not represent a semantic element).

==== On Creation
No element is created. The targeted element is now owned by the source element.

==== Can create
Bug if source is already contained (directly or not) by the target of the link.

==== OnSet
Nothing special.

==== On Reconnect
Cannot be reconnected.

==== On Deletion
Cannot be deleted.

==== On Semantic DnD
Nothing special.

==== On Direct Edit
Nothing special.

==== Label
No label.

image::PackageDiagram/ContainmentLink.png[title="Representation ContainmentLink"]

=== Dependency
Can be created in a Package Diagram, under Model and under a Package.

==== On Creation
Dependency link is stored under the source semantic element.
The source element should be added to the clients feature
The source target element should be added to the supplier feature
This element should not have a default name.

==== Can create
Source and target should be a NamedElement.

==== OnSet
Nothing special.

==== On Reconnect
Dependency link is relocated under the new source semantic element.

==== Container
The container is:
The source node if it can contains the Dependency
The most common Package between the source and the target otherwise

==== On Deletion
No special deletion behavior for this element.

==== On Semantic DnD
No DnD tool since all edges are synchronized

==== On Direct Edit
Nothing special.

==== Label
Nothing special.

image::PackageDiagram/Dependency.png[title="Representation Dependency"]

=== Link (from Comment)
Can be created under a Package Diagram, under a Model or a Package. +
Link is a feature based edge (it does not represent a semantic element).

==== On Creation
No element is created. Tool add the targeted element as an annotatedElement of the Comment.

==== Can create
Source shall be a Comment. +
Target can be anything.

==== OnSet
Nothing special.

==== On Reconnect
Nothing special.

==== On Deletion
Nothing special.

==== On Semantic DnD
Nothing special.

==== On Direct Edit
Not available. Nothing to edit.

==== Label
No label.

image::PackageDiagram/Link_Comment.png[title="Representation Link (from Comment)"]

=== PackageImport
Can be created in a Package Diagram, under Model and under a Package.

==== On Creation
Import link is stored under the source semantic element.

==== Can create
Nothing special.

==== OnSet
Nothing special.

==== On Reconnect
Import link is relocated under the new source semantic element.

==== On Deletion
Nothing special.

==== On Semantic DnD
Nothing special.

==== On Direct Edit
Nothing special.

==== Label
Label shall be &laquo;import&raquo; (followed byt the name of the link).
 
image::PackageDiagram/PackageImport.png[title="Representation PackageImport"]

=== PackageMerge
Can be created in a Package Diagram, under Model and under a Package.

==== On Creation
Merge link is stored under the source semantic element.

==== Can create
(source or target) !=null

==== OnSet
Nothing special.

==== On Reconnect
Merge link is relocated under the new source semantic element.

==== On Deletion
Nothing special.

==== On Semantic DnD
Nothing special.

==== On Direct Edit
Nothing special.

==== Label
Label shall be &laquo;merge&raquo; (followed byt the name of the link).
 
image::PackageDiagram/PackageMerge.png[title="Representation PackageMerge"]


=== PackageMergeEdition

==== On Creation

==== Can Create
(source or target) !=null

==== Container
The container is:
The source node if it can contains this element
The most common Package between the source and the target otherwise

==== On Deletion
No-op

==== On Semantic DnD
no-op

==== On Direct Edit
N/A: no label

==== On reconnection
Merge link is relocated under the new source semantic element.
Source
The container of the PackageMerge should change to the new source
org.eclipse.uml2.uml.PackageMerge.setMergedPackage(Package)
Target
org.eclipse.uml2.uml.PackageMerge.setReceivingPackage(Package)

==== Label
constant value: "merge" (followed byt the name of the link).