ifndef::imagesdir[:imagesdir: imgs]

= User Documentation
:toc:
:toclevels: 4

== Home page

The home page is the starting point of a modeling project. It is where user can initiate a new project or manage an existing one.

Creating a new project in the platform can be done in the following ways:

* Create a blank project
* Create a project from existing templates
* Upload a previously exported project

For more details on project creation topic, see https://docs.obeostudio.com/{sirius-documentation-version}/help_center.html#create-project[`Create a Project`] section of the documentation.

As far as existing projects are concerned, the following actions are available:

* Open an existing project +
To open an existing project, the user has to locate the project in the Project list and click on its name.
* Delete a project +
See the https://docs.obeostudio.com/{sirius-documentation-version}/help_center.html#_delete_a_project[`Delete a Project`] section of the documentation
* Rename a project +
See the https://docs.obeostudio.com/{sirius-documentation-version}/help_center.html#_rename_a_project[`Rename a Project`] section of the documentation

Once the project (new or existing) is chosen, the workbench page is presented.

== Workbench

The Workbench page is the main page where Projects are edited.
It is basically composed of one main central area and two side panels. +
The <<project-explorer-panel,`left panel`>> is mainly used to see the structure of the Project as a tree of all its parts.
The <<diagram-panel,`central area`>> is the place where diagrams live and the <<right-side-panel,`right panel`>> can display the Properties of the current diagram selection.

[[project-explorer-panel]]
=== Project Explorer panel

The Explorer panel displays all elements contained by the _Project_. Root nodes are the _Resources_ stored in the project where all elements underneath live. The root element for _UML_ resources is generally a _Model_ or a _Profile_.

WARNING: Note that the name of the resource should always end with `.uml`.

==== _Explorer Tree_

To create a _New Representation Diagram_, use the contextual menu on any semantic element and choose the action _New Representation_, choose the type of diagram in the dialog.

The _Explorer_ tree contains semantic elements of the _Model_ and diagrams at the same level.
Diagram elements can be easily recognized by the diagram icon image:diagram.svg[diagram icon,16] whereas semantic elements have specific icons depending on their nature.

From the _Explorer_ view, it is possible to create new semantic elements. To do so, use the contextual menu on any semantic element and choose _New Object_. In the dialog, select the new element to create among all semantic elements listed in the dropdown (names are prefixed by the containment feature).

Regarding the representation creation, it is worth noting that _Representations_ depend on the selected semantic element (the one used to open the contextual menu). Here are available representations and their creation contexts:

|===
| Representation | Context

| _Class Diagram_
| _Package_

| _Composite Structure Diagram_
| _Package_

| _Package_
| _Package_

| _Profile Diagram_
| _Profile or Package (in a `.profile.uml` model)_

| _State Machine Diagram_
| _State Machine_

| _Use Case Diagram_
| _Package_

|===

As we can see in the table above, the _State Machine Diagram_ can only be created on a _State Machine_ semantic element.

Deletion of semantic elements (and representation diagrams) is possible through the contextual menu of tree nodes.

==== _Explorer toolbar_

The _Explorer toolbar_ contains global _Project_ actions:

* _Upload model_ +
  Add a previously downloaded UML _Model_ into the _Project_. Accepted UML _Model_ files should have the `.uml` extension
* Synchronization with _Representation_ editor +
  When Synchronization with _Representation_ is *enabled*, selecting a graphical element in the diagram will *_Reveal_* and *_Select_* the semantic element corresponding in the _Explorer_ tree. +
  When Synchronization with _Representation_ is *disabled*, selecting a graphical element in the diagram will *_Select_* the semantic element corresponding in the _Explorer_ tree only if it has already been revealed.

==== Apply profile

To apply a profile use the contextual menu from the root _Model_ element.
Select the profile to apply to the list of candidates.
The available profiles are:

* The static profiles registered in the platform
* The dynamic profiles stored in other projects of your _Papyrus Web_ server.

==== Apply stereotype

To apply a stereotype:

* Make sure that the correct profile is applied on your _Model_
* Use the contextual menu _Apply Stereotype_ on an element
* Select the _Stereotype_ to apply

This stereotype is now displayed in the widget _Applied Stereotypes_ in the _Detail_ panel.

To edit the properties of a _Stereotype_, select the matching _Stereotype Application_ from the _Explorer_ panel.

____
üóíÔ∏è *Note:* You can navigate to a _Stereotype Application_ using the widget _Applied Stereotypes_ in the _Detail_ panel.
____

=== Validation panel

The _Validation_ panel shares the left area of the workbench page with the _Explorer_. See the https://docs.obeostudio.com/{sirius-documentation-version}/help_center.html#_validation_view[documentation section] for more details.

[[diagram-panel]]
=== Diagram panel

==== Generalities

The diagram panel shows _Representation Diagrams_ created in the project. Several _Representations_ can be opened and they appear in separate tabs.
Diagrams represent graphically a part of your semantic model. Each representation defines its own set of rules regarding its content. +
Graphical elements can be selected by clicking on elements. The innermost clicked element is selected.
A red border (with eight square handles) appears around the element when it is selected. +
Once a graphical element is selected, a second click on it will reveal a set of available tools grouped in a horizontal palette.

The Palette displays all the tools available according to the current selection. It has the following subgroups from left to right:

* Children element creation group +
All children's creation actions are grouped in a dropdown list depending on the selected element's nature.
* Generic tools (Edit, Delete from the diagram, Delete from the model, Hide, Fade)
As far as Edit is concerned, it is worth noting that names (or more generally texts) can be edited in the following ways:
 ** Edit action of the Palette
 ** Press F2
+
WARNING: As far as _Edge_ elements are concerned, start and end labels can only be edited by double-clicking them. The above ways will edit the edge label itself (the centered label of the edge).
* Collapse / Expand tools +
Those actions are only available for containers or compartments (e.g _Package_ or _Operations Compartment_ of a _Class_)

The Diagram panel has global actions grouped in a horizontal toolbar underneath the diagram tabs.

image::diagramPalette.png[Labels Overview,400, align="center"]

This toolbar contains the following actions:

* Display full screen
* Fit screen action
* Zoom group
* Share the diagram link
* Export diagram as SVG
* Display Grid
* Reveal hidden elements of action
* Reveal faded elements of action

===== Label
Keywords on Nodes and Edges are displayed on the first separate line of the label. If the semantic element is stereotyped, the stereotype is displayed on a second separate line. Finally, the label will be displayed on the third line. The label can be the simple name of the element, or more complex in some specific cases detailed in the corresponding diagram section.
Label of UML elements with the _isAbstract_ feature set to true is displayed in italic.
Label of UML elements with the _isStatic_ feature set to true is displayed underlined.

image::labelsDisplayed.png[Labels Overview,400, align="center"]

===== Edge Creation
Edges can be created between Nodes whose types match the Edge's source and target types. If the creation of an Edge is not authorized, the target node appears faded. When user try to create an edge, he clicks first on the source element to display arrow. Then he clicks on one of these arrows and stay click until the target. User can see the feedback of the edge and the target node is highlighted. It is not possible for now to create an Edge between two Edges or between an Edge and a Node. 

image::edgeCreation.png[Labels Overview,400, align="center"]

===== Semantic DnD
Users can select elements in the Explorer view and drag and drop them into their container Nodes in the diagram. This drag and drop doesn't perform any semantic modification, except in specific case detailed in the corresponding diagram section. In addition, some diagrams allow semantic drag and drop of any element from the Explorer view (in the same resourceSet as the diagram) on the background of the diagram.  

Dragging and dropping an element represented as an Edge on the diagram will create the source/target elements of the Edge if they aren't already represented. Note that Edges can be dropped anywhere on the diagram, but they will only appear in their semantic container. 

===== Graphical DnD
User can select a node on the diagram and drag and drop it in an other container node. Only authorized containers are revealed on the diagram, forbidden targets are faded. When user try to drag and drop a node, the target container node is highlighted.

image::graphicalDragAndDrop.png[Labels Overview,400, align="center"]

===== Reconnection
Users can reconnect Edges by clicking on the source or target end of the Edge to reconnect, and drag and drop it on a new element. 

==== UseCase Diagram

The UseCase diagram is a graphical description used to represent the different ways a user can interact with a system. Use case diagrams show the functional elements (use cases represented by ellipses), the individuals or objects that invoke these functionalities (actors shown as stick figures), and possibly the elements responsible for implementing these use cases (subjects).

image::diagUseCase.png[UseCase Diagram Overview,800, align="center"]

===== Specific Features on Direct Edit
- The direct edit tool doesn't perform any modification on Link (from Constraint or Comment), Generalization, PackageImport and PackageMerge.

==== Profile Diagram

The Profile diagram provide a way to extend an UML model. They are based on additional stereotypes (identified as classes with the ¬´stereotype¬ª stereotype) and labeled values that are applied to UML element thanks to the _extension_ relation.

image::diagProfile.png[Profile Diagram Overview,800, align="center"]

===== Specific Features on Label
- The label of an Element Import is the label of the UML metaclass it references as its _imported element_.

===== Specific Features on Direct Edit
- The direct edit tool doesn't perform any modification on UML metaclasses, Generalization and Link (from Constraint or Comment).

===== Specific Features on Semantic DnD
- The semantic drag and drop of an Element Import with an UML metaclass as its _imported element_ on the Profile diagram produces a Node with the name of the UML metaclass as its label. Note that it is not possible to drag and drop Element Import with no _imported element_ or with an _imported element_ that is not an UML metaclass. 

===== Specific Features on Reconnection
- Reconnecting an Extension target to a different Class updates the Stereotype property _type_.

[[right-side-panel]]
=== Right side panel

On the right of the page, one can see several stacked views giving information about the current selection.

==== Details

The Details panel is used to visualize and edit all the features of the selected semantic object (from Explorer or diagrams). The panel is divided into 4 separate tabs:

* UML: details the main UML features of the semantic element
* Comments: displays comments associated with the selected element. Those comments can be owned by the element or applied to it (using a relation between the comment and this element).
* Profile: focus on applied stereotypes/profiles of this selected element
* Advanced: This tab displays all features of the semantic element. It uses generic rules to find the best suitable widget to visualize and edit the feature.

In the UML tab, each property is represented by an appropriated widget according to its nature. For instance, a property of type `ecore::EString` will be represented by a text widget. It might be, in some situations more appropriate to represent this string with a text area widget that supports multiple lines of text.

===== UML panel

====== Basic widgets

In the following table, we present the mapping between basic types and their associated widgets

|===
| Basic Type | Widget

| _Mono Boolean_
| _Checkbox_

| _Mono String_
| _Text field_ or _Text area_

| _Mono Number_
| _Text field_

| _Mono Enumeration_
| _Select_ or _Radio_

| _Many Boolean, String, Number, Enumeration_
| _Primitive List_

| _Many and Mono Reference_
| _Reference_
|===

Here is https://docs.obeostudio.com/{sirius-documentation-version}/help_center.html#_details_view[the Sirius documentation] of all those widgets.

====== Custom widgets

Some UML 2 concepts have properties that need a special UI to manage their data. Here are the details of each custom widget.

======= Language Expression

A language expression custom widget has been introduced to manage a couple of connected lists in the following concepts:

* `FunctionBehavior`
* `OpaqueAction`
* `OpaqueBehavior`
* `OpaqueExpression`

All those concepts manage a couple of lists of `strings` which are weakly connected via their index. The first list, called '[.code]``languages``' contains the name of languages, such as `"JAVA"` or `pass:c["C++"]`. The second one contains the body expression expressed in the language of the same rank in the list. Thus those lists could not be edited in Papyrus UI as separate ordinary lists of text fields. This is the reason why a new custom widget has been developed.

image::languageexpression.png[language expression custom widget,400, align="center"]

The above image shows the custom widget associated with the virtual property '[.code]``language``' of a `FunctionBehavior`. The plus icon in front of the property label can be used to populate the following list by adding a predefined language or a new one. This selection of the language to add is done using a modal dialog.

Each language in the list is shown as a collapsible section with the name of the language as the title. On the right part of the header/title section, there is the section toolbar containing all actions that can be performed in this language. Once a language is expanded, the body of the language is revealed and the user can modify it. Only one language is expanded at a time. An expanded language will be automatically collapsed if the user expands another one.

Languages can be reordered using up or down actions of the toolbar. Since the list is not a ring, the user is not allowed to move up the first language or move down the last one.

Removing a language can be done using the trash icon action of its toolbar. No confirmation is required before deleting a language element.

======= Primitive List

The primitive list custom widget aims to provide capabilities to visualize and edit _EAttributes_ which represent more than one value.

image::primitive-list.png[align="center"]

The values are represented as list items.
Each item can be deleted using the _trash_ icon.
To add a value, the _New item_ input can be used.
Be aware that the server receives a _String_ value and needs to convert it to the correct _DataType_.
For widgets used in the default pages of the _Details_ view, Papyrus Web uses pure _EMF_ implementation to convert the given _String_ into the required _DataType_.
It is also possible provide a strict list of candidates for enumeration or boolean, for example.
In that case, the list of possible values are presented in a dropdown whereas the text field is used as a filter of those values.
Once the user chooses the value, it may be added using the plus icon action.
For example, for a _boolean_ feature, there are only two value allowed _true_ and _false_.

In the context of _UML_, for a more exhaustive list of conversion rule look at:

* _org.eclipse.uml2.uml.internal.impl.UMLFactoryImpl.createFromString(EDataType, String)_
* _org.eclipse.uml2.types.internal.impl.TypesFactoryImpl.createFromString(EDataType, String)_

The primitive list has also the capability to reorder its items. This is an optional capability that is controlled by the presence of an expression inside the view model of the widget. If such an expression is provided an reorder icon appears on the left of the list title as displayed below:

image::primitive-list-with-reorder-action.png[primitive list with reorder action, 500, align="center"]

Triggering this reorder icon opens a dialog in which the user can change the order of the list items:

image::primitive-list-reorder-dialog.png[width=300, height=360, align="center"]

The primitive list custom widget can be configured to have a single extra action on each item.
This item action is optional but its setting is for all items or none. 
One can control the UI appearance of the action by setting its icon file.

As an example, the following image shows a paperclip icon for the item action and when the user clicks an information pops up with the clicked item name.

image::primitive-list-with-item-action.png[primitive list with item action, 500, align="center"]

======= References

Depending on the nature of the reference, we handle it differently. 
Containment references use a dedicated custom widget, while non-containment references use Sirius components reference widgets.

Containment reference widget

In those references, reference values are child nodes of the reference owner, which means that the elements referenced in the widget can be found underneath the reference owner. 
For instance, a class that has two operations set in its `Owned Operations` property can be found as children nodes of the _Class_ node in the _Model Explorer_

image::containment-reference.png[containment reference widget, 500, align="center"]
image::containment-children.png[align="center"]

The containment reference widget has the following actions available:

 * The plus icon to change the reference value +
 It starts to create a new child element. 
 If the specified type of the reference has derived types, a modal dialog is open to choose the actual type of the new element.
 After its creation, the new element is set as the reference value in case this reference is a mono-valued one, or added to the reference value list otherwise. 
 
[WARNING]
====
In case of mono-valued containment reference, if the value is already set, the user is not allowed to create a new element and the plus icon is disabled. 
 In this situation, the user has to remove first the current value before creating a new one.
====

 * The reorder icon to sort the reference values (optional: only for multi-valued references). +
 Reordering values can be done manually inside a dedicated dialog: 

image::containment-reference-reorder-dialog.png[width=300, height=360, align="center"]

 * The cross icon on each value element to remove this value in the reference *and* delete the element from the model.
 * Clicking value elements inside the reference navigates to those elements.   

Non-containment reference widget

Non-containment references are managed using the Sirius components reference widget.

image::reference.png[non-containment reference widget, 500, align="center"]

Actions available in non-containment reference widgets are:

* Ellipsis icon to set/edit the value of the reference using a dialog:

image::reference-set-mono.png[mono-valued set, 400, align="center"]

In a mono-valued reference, the user can select a compatible element to set in the reference (this element will possibly replace the current reference value)

image::reference-set-multi.png[multi-valued edit, 600, align="center"]

Whereas in a multi-valued reference, the dialog allows the user to manage the list of reference values. 
The left panel contains compatible elements within the editing context.
Elements  displayed with a bold label are elements that are currently present in the reference value list.
This list can be seen in the right panel.
Icons in between those panels can be used to move a selected element from right to left (remove operation) or from left to right (add operation).
Moving elements can also be performed by dragging an element from a panel and dropping it to the other one.
Finally, current elements (in the right panel) can be reordered using drag and drop.

* The plus icon to create a new element and change the reference value. +
Since new element is not contained by the reference owner, user has to first specify the new element's container and the actual type of element to create.
This is done inside the create dialog:

image::reference-create.png[creation dialog, 500, align="center"]

For a mono-value reference, once the new element is created it is set as the reference value and replaces its current value.
In case of a multi-valued reference, the new element is added at the end of the value list.

* The trash icon to clear the reference value.
* The dropdown icon to choose a value among compatible elements (not already present in the reference value) found in the editing context. +
For a mono-valued reference the selected value replace the existing one, whereas it is added to the value list in case of multi-valued.
* The user can type some text in the values area to filter dropdown list content.
* Each value element has a cross icon to remove it from the reference. +
Since this is a non-containment reference, the removed element is only removed from its value and the referenced element still exists in the model.
* Clicking value elements inside the reference navigates to those elements. 

Rule for searching candidate values of non-containment reference

As we have seen in previous sections, the dialogs to set (or edit) value references and the dropdown collect all possible compatible values for a reference.
This is done with a dedicated UML domain service.
This service is in charge of finding all reachable elements from the element owing the reference that are compatible with the type of the reference.
The following algorithm is used to perform this search:

- Starting from the element owning the reference, all elements of the current model are reachable.
- _PackageImport_ elements found in between the element itself and the root of the model are collected.
- All imported packages of those _PackageImport_ elements and their content are reachable.
- The previous steps are recursively applied for each imported package.

[NOTE]
====
Since the above search rule is using _PackageImport_ element and its `importedPackage` reference, this rule cannot be applied to this specific reference.
Therefore, a special treatment is applied for this reference in order to compute the list of reachable _Package_ elements from a _PackageImport_ element.
In this special case, the collection of reachable elements is built by browsing all the loaded resources to collect every contained _Package_ elements.
====

===== Definition panel

When a Profile element is selected (for instance inside the _Explorer_), the definition tab is shown in the Details panel.
The _Definition_ page contains all profile's version detailed information. 
These information are those typed inside the dialog each time the profile is published. 

image::profile-definition-page.png[profile definition page, align="center"]

All profile definitions are stacked together with the more recent version on top of the panel. +
Each profile definition can be removed using the trash button. 

WARNING: The remove action only remove the profile definition from the model.
It does not "unpublish" the profile.

==== Related Elements

There is a section about the link:++https://docs.obeostudio.com/{sirius-documentation-version}/help_center.html#project-editor++[_Related Elements view_] in the documentation.

==== Representations

There is a section about link:++https://docs.obeostudio.com/{sirius-documentation-version}/help_center.html#_representations_view++[_Representations view_] in the documentation.
